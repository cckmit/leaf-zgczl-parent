<?xml version="1.0" encoding="UTF-8"?>
<a:screen xmlns:a="http://www.leaf-framework.org/application" trace="true">
    <a:view>
        <script><![CDATA[
        function summaryRenderer(datas, name) {
            var sum = 0;
            var sum2 = 0;
            for (var i = 0; i < datas.length; i++) {
                record = datas[i];
                if (name == "creditamount") {
                    var t_1 = record.get("creditamount");
                    var t_2 = parseFloat(t_1);
                    if (!isNaN(t_2)) {
                        sum += t_2;
                    }
                }
                if (name == "debitamount") {
                    var d_1 = record.get("debitamount");
                    var d_2 = parseFloat(d_1);
                    if (!isNaN(d_2)) {
                        sum2 += d_2;
                    }
                }
            }
            if (name == "recipname") {
                return '<div align="right">合计:</div>';
            }
            if (name == "creditamount") {
                return '<font color="red">' + Leaf.formatNumber(sum, 2) + '</font>';
            }
            if (name == "debitamount") {
                return '<font color="red">' + Leaf.formatNumber(sum2, 2) + '</font>';
            }
        }

        ]]></script>
        <a:dataSets>
            <a:dataSet id="ope_bank_detail_ds" model="bank.BANK100.bank_details_query" autoPageSize="false" fetchAll="true"
                       queryUrl="${/request/@context_path}/autocrud/bank.BANK100.bank_details_query/query?recip_name=${/parameter/@recip_name}"
                       autoQuery="true">
            </a:dataSet>
        </a:dataSets>
        <a:screenBody>
            <a:screenTopToolbar>
                <a:screenTitle/>
            </a:screenTopToolbar>
            <a:grid id="ope_bank_detail_grid" bindTarget="ope_bank_detail_ds" navBar="true" autoAdjust="true" height="325"
                    width="550">
                <a:toolBar>
                    <a:button type="excel"/>
                </a:toolBar>
                <a:columns>
                    <a:column name="recipname" align="left" lock="true" prompt="对方户名" width="220" footerRenderer="summaryRenderer"/>
                    <a:column name="creditamount" align="right" lock="true" prompt="转入金额" width="110" footerRenderer="summaryRenderer"/>
                    <a:column name="debitamount" align="right" lock="true" prompt="转出金额" width="110" footerRenderer="summaryRenderer"/>
                    <a:column name="trandate" align="left" lock="true" prompt="交易日期" width="110"/>
                </a:columns>
            </a:grid>
        </a:screenBody>
    </a:view>
</a:screen>
